## Malware Study

----------------

## Malicious Database

| Project Name                          | Description                                                                                                                                                      | Link                                                  |
|---------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
| **theZoo**                            | A project providing open access to malware analysis, gathering various malware versions accessible to the public.                                                 | [theZoo](https://github.com/ytisf/theZoo)             |
| **Popular Malware Feed**              | Collected through a global honeypot project developed with collaborators, offering a feed of malware samples.                                                    | [Popular Malware Feed](https://github.com/fabrimagic72/malware-samples) |
| **CISA/Gov Malware Samples**          | Contains malware samples collected from various sources to stay current with public reports, simplifying the retrieval of files based on published IOCs.        | [CISA/Gov Malware Samples](https://github.com/MalwareSamples/Malware-Feed) |
| **Virus Samples and Great Resource**  | Provides a comprehensive repository of virus samples for researchers, simplifying malware analysis.                                                              | [Virus Samples and Great Resource](https://github.com/Virus-Samples/Malware-Sample-Sources) |
| **Linux Malware Samples**             | Aims to assist by providing a static repository of Linux ELF Binaries and various virus samples for analysis and research.                                       | [Linux Malware Samples](https://github.com/MalwareSamples/Linux-Malware-Samples) |
| **MacOS Malware Samples**             | Designed to assist researchers and analysts in locating malicious Macintosh binaries related to Apple and MacOS.                                                 | [MacOS Malware Samples](https://github.com/MalwareSamples/Macos-Malware-Samples) |
| **Ransomware Samples**                | Aims to assist by providing Ransomware and other virus samples for various research and analysis purposes.                                                       | [Ransomware Samples](https://github.com/MalwareSamples/Ransomware-Malware-Samples) |
| **Recent Malware**                    | A collection of malware samples and relevant dissection information, usually referenced from specific blogs or social media.                                     | [Recent Malware](https://github.com/InQuest/malware-samples) |
| **~750k Database**                    | Features a large corpus of malware samples, with capabilities to view and download individual samples.                                                           | [~750k Database](https://bazaar.abuse.ch/browse/)     |
| **300TB approx 600 million samples**  | A massive collection of nonredundant malware samples available through a subscription service, with a free tier available.                                       | [300TB approx 600 million samples](https://www.virussign.com/) |
| **Malware in PCAP files**             | Over 100k malicious PCAP files for analysis and research.                                                                                                        | [Malware in PCAP files](https://lab.dynamite.ai/)     |
| **20 Million Reverse Engineered Malware** | Nearly 20 million files with features, labels, and metadata for malware analysis, including disarmed samples for exploration.                                   | [20 Million Reverse Engineered Malware](https://github.com/sophos/SOREL-20M) |
| **40k JavaScript Malware Samples**    | An extensive collection of JavaScript malware samples, primarily from 2015-2019.                                                                                | [40k JavaScript Malware Samples](https://github.com/HynekPetrak/javascript-malware-collection) |
| **Famous Malware**                    | A repository full of various infamous malware samples.                                                                                                           | [Famous Malware](https://github.com/Da2dalus/The-MALWARE-Repo) |
| **Malicious Network Traffic**         | IoT-23 dataset includes network traffic from IoT devices, with labeled malware and benign traffic for machine learning research.                                 | [Malicious Network Traffic](https://www.stratosphereips.org/datasets-iot23) |
| **57,293 malware and 77,142 benign samples** | BODMAS offers a large collection of malware and benign samples, with curated family data for research.                                                          | [57,293 malware and 77,142 benign samples](https://whyisyoung.github.io/BODMAS/) |
| **Malicious Network Traffic Dataset** | HIKARI-2021 focuses on generating a dataset based on real and encrypted synthetic attack traffic for network intrusion detection.                                | [Malicious Network Traffic Dataset](https://zenodo.org/records/5199540) |
| **ISOT HTTP Botnet Dataset**          | A comprehensive dataset combining several existing malicious and non-malicious datasets for botnet and ransomware detection.                                     | [ISOT HTTP Botnet Dataset](https://onlineacademiccommunity.uvic.ca/isot/2022/11/27/botnet-and-ransomware-detection-datasets/) |
| **vx-underground**                    | Provides a vast collection of malware samples, articles, and documentation aimed at researchers and enthusiasts. Much of the listed above samples are included in their dataset. | [vx-underground](https://vx-underground.org) |



## Resources
- https://github.com/rshipp/awesome-malware-analysis

## Other
- https://github.com/marcoramilli/MalwareTrainingSets/tree/master



----------------

## Obfuscation

**Packing** is a common method used to hide the true nature of malicious code from antivirus software and analysis tools. The concept of "packing" in this case is somewhat analogous to compression, but with a focus on obfuscation rather than just size reduction.

Sometimes, malware is packed multiple times, requiring unpacking of several layers before revealing the actual malicious code. This is known as **Layered Packing**.

----------------
Packing Tools:

- **ConfuserEx** - ConfuserEx is a open-source protector for .NET applications. Perfect for executables build in PowerShell. This project even has its own GUI -- making its incredibly easy to get started. [https://github.com/mkaring/ConfuserEx]
- **UPX** - UPX is a free, secure, portable, extendable, high-performance
executable packer for several executable formats. [https://github.com/upx/upx]
*-upx does not work on .NET executables, such as those made using PowerShell-*

----------------
To better conceal the source code and evade detection, employ obfuscation techniques such as repeatedly renaming variables, utilizing the most concise form of a cmdlet, randomizing characters, and generally rendering the code difficult to comprehend. We will refer to this process as **Hardcoded Obfuscation**. 

----------------

Hardcoded Obfuscation:

- **ShellSync Obfuscation**: ShellSync Obfuscation is a service that employs polymorphic methods to conceal PowerShell scripts. [https://shellsync.wtf/]

----------------

**Encryption** is a method of encoding information to make it indecipherable to unauthorized users. Hackers often employ encryption to conceal malware, rendering it difficult for security measures to detect and analyze the malicious code.

Common encryption types to evade detection:

- **AES (Advanced Encryption Standard)** - PowerShell has built-in AES capabilities. This is part of the .NET Framework, which PowerShell can access.
- **Custom algorithms** - Custom encryption algorithms are also used to evade antivirus detection, adding complexity to confuse security systems.

----------------

## Attack Vectors

An attack vector in cybersecurity is a method or pathway used by a hacker to gain unauthorized access to a system or network to deliver a payload or malicious outcome.

- **DLL Hijacking**: - DLL hijacking is a security vulnerability that occurs when an application mistakenly loads a malicious Dynamic Link Library (DLL) file, thinking it is a legitimate one. For example, if an application tries to load a DLL named "example.dll" without specifying a path, and a hacker places a malicious "example.dll" in a directory that the application searches before the legitimate one, the application will load and execute the malicious DLL instead. Most importantly, DLL hijacking can bypass UAC protections by exploiting a trusted application's search and load mechanism for DLLs, allowing malware to be executed with elevated privileges without triggering UAC prompts.
- **Shortcut Hijacking**: - Shortcut hijacking refers to the manipulation of a shortcut (.LNK) file's properties, such as altering its Target path to execute malicious commands via cmd.exe and changing its icon (e.g., to a PDF or folder icon), to deceive users into executing harmful actions, as exemplified by the Raspberry Robin Worm.
